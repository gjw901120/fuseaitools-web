import{p as d}from"./C0Gp0dND.js";const A=()=>{const i=()=>{try{const{token:e}=d();return e.value?e.value:localStorage.getItem("auth_token")}catch{return localStorage.getItem("auth_token")}},a=async(e,r={})=>{var s,c;try{const t=i(),n={...r,headers:{"Content-Type":"application/json",Accept:"application/json",...r.headers}};t&&(n.headers.Authorization=`Bearer ${t}`),n.credentials="include",n.mode="cors";const o=await $fetch(e,n);if(o&&typeof o=="object"&&"errorCode"in o){if(o.errorCode==="00000")return o.data;{const p=o.errorMessage||o.userTip||"Request failed",u=new Error(p);throw u.__fromApi=!0,u}}return o}catch(t){if(console.error("API request error:",t),t.__fromApi)throw t;const n=((s=t.data)==null?void 0:s.errorMessage)||((c=t.data)==null?void 0:c.userTip)||t.message||"Network error. Please try again.";throw new Error(n)}};return{request:a,get:(e,r={})=>a(e,{method:"GET",...r}),post:(e,r,s={})=>a(e,{method:"POST",body:r,...s}),put:(e,r,s={})=>a(e,{method:"PUT",body:r,...s}),delete:(e,r={})=>a(e,{method:"DELETE",...r})}};export{A as u};
