{"file":"GPT4oImageTool-DsDrJcLq.js","mappings":";;;;;;;;;;AAAuD,MAAA,aAAe,gBAAgB,yBAAyB;;;;;AC2OhG,cAAA;AACf,UAAM,QAAQ,SAAA;AACI,YAAA;AAClB,UAAM,EAAE,UAAA,IAAc,SAAA;AACtB,UAAM,EAAe,UAAU,cAAA,IAAkB,cAAA;AAKjD,UAAM,sBAAsB,SAAS,MAAM;AACzC,YAAM,UAAU,SAAS,cAAc;AACvC,YAAM,MAAM,cAAc,OAAO;AACjC,aAAO,MAAM,IAAI,GAAG,MAAM;AAAA,IAC5B,CAAC;AAED,UAAM,WAAW,SAAS;AAAA,MACxB,MAAM;AAAA,MACN,QAAQ;AAAA,MACR,UAAU,CAAA;AAAA,MACV,WAAW;AAAA,IAAA,CACZ;AAED,UAAM,eAAe,IAAI,KAAK;AAC9B,UAAM,kBAAkB,IAAI,KAAK;AACjC,UAAM,kBAAkB,IAAI,EAAE;AAC9B,UAAM,gBAAgB,IAAI,EAAE;AAC5B,UAAM,2BAA2B,IAAI,IAAI;AAEzC,UAAM,eAAe,MAAM;AACJ,aAAO;AAAA,IAO9B;AAEA,UAAM,wBAAwB,OAAO,UAAU;;AAC7C,UAAI,CAAC,MAAM,QAAQ,KAAK,KAAK,MAAM,WAAW,GAAG;AAC/C,sBAAc,QAAQ,CAAA;AACtB,iBAAS,WAAW,CAAA;AACpB;AAAA,MACF;AAEA,sBAAgB,QAAQ;AACxB,UAAI;AACF,cAAM,iBAAiB,IAAI,SAAA;AAC3B,cAAM,QAAQ,CAAA,SAAQ,eAAe,OAAO,QAAQ,IAAI,CAAC;AAEzD,cAAM,UAAU,EAAE,QAAQ,mBAAA;AAC1B,cAAM,YAAY,aAAA;AAClB,YAAI,UAAW,SAAQ,eAAe,IAAI,UAAU,SAAS;AAE7D,cAAM,WAAW,MAAM,MAAM,4BAA4B;AAAA,UACvD,QAAQ;AAAA,UACR;AAAA,UACA,MAAM;AAAA,UACN,aAAa;AAAA,QAAA,CACd;AAED,YAAI,CAAC,SAAS,IAAI;AAChB,gBAAM,YAAY,MAAM,SAAS,KAAA,EAAO,MAAM,OAAO,CAAA,EAAG;AAExD,gBAAM,MACH,QAAO,uCAAW,kBAAiB,YAAY,UAAU,aAAa,KAAA,IACnE,UAAU,aAAa,KAAA,IACtB,QAAO,uCAAW,aAAY,YAAY,UAAU,QAAQ,KAAA,IAC3D,UAAU,QAAQ,KAAA,KACjB,uCAAW,aAAW,uCAAW,WAAS,uCAAW,YAAW;AACzE,gBAAM,IAAI,MAAM,GAAG;AAAA,QACrB;AAEA,cAAM,OAAO,MAAM,SAAS,KAAA;AAC5B,YAAI,OAAO,CAAA;AACX,YAAI,KAAK,cAAc,aAAW,UAAK,SAAL,mBAAW,SAAQ,MAAM,QAAQ,KAAK,KAAK,IAAI,GAAG;AAClF,iBAAO,KAAK,KAAK;AAAA,QACnB,aAAW,UAAK,SAAL,mBAAW,SAAQ,MAAM,QAAQ,KAAK,KAAK,IAAI,GAAG;AAC3D,iBAAO,KAAK,KAAK;AAAA,QACnB,WAAW,KAAK,YAAY,MAAM,QAAQ,KAAK,QAAQ,GAAG;AACxD,iBAAO,KAAK;AAAA,QACd;AAEA,YAAI,KAAK,WAAW,GAAG;AACrB,gBAAM,IAAI,MAAM,uCAAuC;AAAA,QACzD;AAEA,iBAAS,WAAW;AACpB,sBAAc,QAAQ,MAAM,IAAI,CAAC,MAAM,OAAO;AAAA,UAC5C,MAAM,KAAK;AAAA,UACX;AAAA,UACA,KAAK,KAAK,CAAC,KAAK,IAAI,gBAAgB,IAAI;AAAA,QAAA,EACxC;AAAA,MACJ,SAAS,OAAO;AACd,gBAAQ,MAAM,kCAAkC,KAAK;AACrD,kBAAU,MAAM,WAAW,qCAAqC,GAAI;AACpE,sBAAc,QAAQ,CAAA;AACtB,iBAAS,WAAW,CAAA;AAEpB,6CAAyB,UAAzB,mBAAgC,eAAhC;AAAA,MACF,UAAA;AACE,wBAAgB,QAAQ;AAAA,MAC1B;AAAA,IACF;AAGA,UAAM,EAAE,uBAAuB,mBAAA,IAAuB,iBAAA;AAGtD,UAAM,gBAAgB,SAAS,MAAM,MAAM,MAAM,WAAW,KAAK,EAAE;AACnE,UAAM,eAAe,SAAS,MAAM,CAAC,CAAC,cAAc,KAAK;AACzD,UAAM,aAAa,IAAI,IAAI;AAC3B,UAAM,gBAAgB,IAAI,KAAK;AAE/B,UAAM,kBAAkB,IAAI,IAAI;AAEhC,UAAM,qBAAqB,SAAS,MAAM;;AACxC,UAAI,CAAC,WAAW,SAAS,CAAC,MAAM,QAAQ,WAAW,MAAM,UAAU,EAAG,QAAO,CAAA;AAC7E,YAAM,OAAO,WAAW,MAAM;AAC9B,YAAM,SAAO,gBAAW,MAAM,iBAAjB,mBAA+B,SAAQ;AACpD,aAAO,KAAK,IAAI,CAAC,KAAK,MAAA;;AAAO;AAAA,UAC3B,IAAI,UAAU,CAAC;AAAA,UACf,KAAK,OAAO,QAAQ,WAAW,OAAM,2BAAK,SAAO,2BAAK,aAAY;AAAA,UAClE;AAAA,UACA,YAAW,oBAAI,KAAA,GAAO,mBAAA;AAAA,UACtB,SAAQA,MAAA,WAAW,MAAM,iBAAjB,gBAAAA,IAA+B;AAAA,QAAA;AAAA,OACvC,EAAE,OAAO,CAAA,QAAO,IAAI,GAAG;AAAA,IAC3B,CAAC;AAED,aAAS,yBAAyB,cAAc;AAC9C,UAAI,CAAC,gBAAgB,OAAO,iBAAiB,SAAU;AACvD,UAAI,aAAa,KAAM,UAAS,OAAO,aAAa;AACpD,UAAI,OAAO,aAAa,WAAW,SAAU,UAAS,SAAS,aAAa;AAC5E,UAAI,MAAM,QAAQ,aAAa,SAAS,YAAY,WAAW,CAAC,GAAG,aAAa,SAAS;AACzF,UAAI,OAAO,aAAa,cAAc,UAAW,UAAS,YAAY,aAAa;AAAA,IACrF;AAEA,aAAS,mBAAmB;AAC1B,aAAO,MAAM,MAAM,WAAW,KAAK;AAAA,IACrC;AACA,mBAAe,qBAAqB,UAAU;AAC5C,UAAI,CAAC,SAAU;AACf,UAAI,iBAAA,MAAuB,SAAU;AACrC,UAAI,gBAAgB,UAAU,SAAU;AACxC,sBAAgB,QAAQ;AACxB,oBAAc,QAAQ;AACtB,iBAAW,QAAQ;AACnB,UAAI;AACF,cAAM,OAAO,MAAM,sBAAsB,QAAQ;AACjD,YAAI,iBAAA,MAAuB,SAAU;AACrC,mBAAW,QAAQ,QAAQ;AAC3B,YAAI,6BAAM,aAAc,0BAAyB,KAAK,YAAY;AAClE,YAAI,QAAQ,QAAQ,OAAO,KAAK,MAAM,MAAM,GAAG;AAC7C,6BAAmB,UAAU,EAAE,gBAAgB,MAAM,uBAAuB,UAAU,EAAE,KAAK,CAAC,WAAW;AACvG,gBAAI,iBAAA,MAAuB,SAAU;AACrC,uBAAW,QAAQ;AACnB,gBAAI,iCAAQ,aAAc,0BAAyB,OAAO,YAAY;AAAA,UACxE,CAAC,EAAE,MAAM,MAAM;AAAA,UAAC,CAAC;AAAA,QACnB;AAAA,MACF,SAAS,GAAG;AACV,gBAAQ,MAAM,8BAA8B,CAAC;AAAA,MAC/C,UAAA;AACE,YAAI,gBAAgB,UAAU,SAAU,iBAAgB,QAAQ;AAChE,sBAAc,QAAQ;AAAA,MACxB;AAAA,IACF;AAEA;AAAA,MACE,MAAM,MAAM,MAAM,WAAW;AAAA,MAC7B,CAAC,aAAa;AACZ,YAAI,+BAA+B,QAAQ;AAAA,aACtC;AACH,0BAAgB,QAAQ;AACxB,qBAAW,QAAQ;AAAA,QACrB;AAAA,MACF;AAAA,MACA,EAAE,WAAW,KAAA;AAAA,IAAK;;mBA1ZbC,eAAAC,WAAA,EAAA,OAAM,mBAAA,GAAkB,MAAA,CAAA,kJAKhBC,cAAA,OAAA,UAA6B,6cAkBWC,sBAAA,aAAA,SAAgB,aAAA,KAAY,IAAA,cAAA,oKAOjDC,eAAA,CAAA,EAAA,QAAA,SAAS,SAAI,MAAA,GAAA,YAAA,CAAA,wEAObA,eAAA,CAAA,EAAA,QAAA,SAAS,SAAI,MAAA,GAAA,YAAA,CAAA,6HAQbA,eAAA,CAAA,EAAA,QAAA,SAAS,SAAI,SAAA,YAAA,CAAA,gVAaxBC,eAAA,SAAS,MAAM;;iBAYpB;AAAA,QAAJ,KAAI;AAAA,QACJ,YAAS;AAAA,QACT,OAAM;AAAA,QACN,eAAY;AAAA,QACZ,eAAY;AAAA,QACZ,eAAY;AAAA,QACX,aAAW;AAAA,QACX,iBAAe,KAAA,OAAA;AAAA,QAChB,mBAAgB;AAAA,QAChB,eAAY;AAAA,QACX,kBAAc;AAAA,MAAA;UAEN,gBAAA,OAAe;;;;;iIAQQF,sBAAA,MAAA,QAAA,SAAS,SAAS,IAAlBG,gBAAA,SAAS,WAAS,IAAA,IAAlB,SAAS,SAAS,IAAA,aAAA,4KAOrBH,sBAAA,aAAA,SAAY,CAAK,SAAS,OAAO,KAAA,CAAI,IAAA,cAAA;UAC3D,aAAA,OAAY;;;;;+BAElB,aAAA,QAAY,kBAAA,gBAAA,mBAA2C,oBAAA,KAAmB;WAU7C,aAAA,SAAgB,gBAAA,MAAgB,SAAM,GAAA;;;;;;UAS7D,aAAA,SAAgB,oBAAc,WAAA,MAAW,WAAM,KAAU,mBAAA,MAAmB,SAAM,GAAA;;sBAC7D,mBAAA,OAAkB,CAAnC,OAAO,UAAK;wHAEf,OAAK,MAAM,GAAG,IAAGD,cAAA,0BAAwB,QAAK,CAAA,EAAA,+VAWxBG,eAAA,MAAM,IAAI,oDACVA,eAAA,MAAM,SAAS;;;MAKjC,WAAA,aAAA,SAAgB,WAAA,SAAc,WAAA,MAAW,WAAM,GAAA;;MAK/C,WAAA,aAAA,UAAY,CAAM,WAAA,SAAc,WAAA,MAAW,WAAM,IAAA;;iBAKjD,aAAA,OAAY;;kBAIX,aAAA,SAAgB,gBAAA,MAAgB,SAAM,GAAA;;sBACvB,gBAAA,OAAe,CAAhC,OAAO,UAAK;wHAEf,OAAK,MAAM,GAAG,IAAGH,cAAA,0BAAwB,QAAK,CAAA,EAAA,+VAWxBG,eAAA,MAAM,IAAI,oDACVA,eAAA,MAAM,SAAS;;;kBAMhC,aAAA,OAAY;;;;;;;;;;;;;;;;","names":["_a","_ssrRenderAttrs","_mergeProps","_ssrRenderAttr","_ssrIncludeBooleanAttr","_ssrRenderClass","_ssrInterpolate","_ssrLooseContain"],"sources":["../../../../virtual:public?%2Ftools-logo%2FChatGpt.png","../../../../components/tools/GPT4oImageTool.vue"],"sourcesContent":["import { publicAssetsURL } from '#internal/nuxt/paths';export default publicAssetsURL(\"/tools-logo/ChatGpt.png\")","<template>\n  <div class=\"gpt4o-image-tool\">\n    <!-- Tool Header -->\n    <div class=\"tool-header\">\n      <div class=\"header-left\">\n        <div class=\"tool-icon\">\n          <img src=\"/tools-logo/ChatGpt.png\" alt=\"GPT-4o Image\" />\n        </div>\n        <div class=\"tool-info\">\n          <h3>GPT 4o Image</h3>\n          <p>OpenAI GPT-4o image generation tool</p>\n        </div>\n      </div>\n    </div>\n\n    <!-- Main Content Area: Left (1/3) and Right (2/3) -->\n    <div class=\"main-content\">\n      <!-- Left: Parameter Configuration Panel -->\n      <div class=\"config-panel\">\n        <div class=\"config-header\">\n          <h4>Image Generation Configuration</h4>\n        </div>\n\n        <form class=\"config-form\" @submit.prevent=\"generateImage\">\n          <fieldset class=\"config-fieldset\" :disabled=\"isGenerating || isDetailView\">\n          <!-- ÂõæÁâáÂ∞∫ÂØ∏ÈÄâÊã© -->\n          <div class=\"form-group\">\n            <label>Image Aspect Ratio *</label>\n            <div class=\"tab-group\">\n              <div \n                class=\"tab-option\"\n                :class=\"{ active: formData.size === '1:1' }\"\n                @click=\"formData.size = '1:1'\"\n              >\n                <span>1:1</span>\n              </div>\n              <div \n                class=\"tab-option\"\n                :class=\"{ active: formData.size === '3:2' }\"\n                @click=\"formData.size = '3:2'\"\n              >\n                <i class=\"fas fa-rectangle-wide\"></i>\n                <span>3:2</span>\n              </div>\n              <div \n                class=\"tab-option\"\n                :class=\"{ active: formData.size === '2:3' }\"\n                @click=\"formData.size = '2:3'\"\n              >\n                <i class=\"fas fa-rectangle-portrait\"></i>\n                <span>2:3</span>\n              </div>\n            </div>\n          </div>\n\n          <!-- ÊèêÁ§∫ËØçËæìÂÖ• -->\n          <div class=\"form-group\">\n            <label>Prompt *</label>\n            <textarea\n              v-model=\"formData.prompt\"\n              placeholder=\"Describe the image content you want to generate...\"\n              rows=\"4\"\n              class=\"form-input\"\n              required\n            ></textarea>\n            <div class=\"input-hint\">At least one of Reference Images and prompt is required</div>\n          </div>\n\n          <!-- Êñá‰ª∂‰∏ä‰º† -->\n          <div class=\"form-group\">\n            <UploadImage\n              ref=\"referenceImagesUploadRef\"\n              input-id=\"gpt4o-reference-images\"\n              label=\"Reference Images (Optional)\"\n              upload-icon=\"fas fa-cloud-upload-alt\"\n              upload-text=\"Click to upload reference images\"\n              upload-hint=\"Supports .jfif, .jpeg, .jpg, .png, .webp (max 5 images)\"\n              :max-files=\"5\"\n              :max-file-size=\"10 * 1024 * 1024\"\n              additional-hint=\"Upload reference images to guide generation direction\"\n              theme-color=\"#667eea\"\n              @update:files=\"handleReferenceImages\"\n            />\n            <div v-if=\"isUploadingRefs\" class=\"uploading-hint\">\n              <i class=\"fas fa-spinner fa-spin\"></i> Uploading reference images...\n            </div>\n          </div>\n\n          <!-- ÊèêÁ§∫Â¢ûÂº∫ -->\n          <div class=\"form-group\">\n            <label class=\"checkbox-label\">\n              <input type=\"checkbox\" v-model=\"formData.isEnhance\" />\n              <span class=\"checkmark\"></span>\n              Prompt Enhancement (Suitable for 3D images and specific scenarios)\n            </label>\n          </div>\n\n          <!-- ÁîüÊàêÊåâÈíÆ -->\n          <button type=\"submit\" :disabled=\"isGenerating || !formData.prompt.trim()\" class=\"generate-btn\">\n            <i v-if=\"isGenerating\" class=\"fas fa-spinner fa-spin\"></i>\n            <i v-else class=\"fas fa-magic\"></i>\n            {{ isGenerating ? 'Generating...' : 'Generate Image' }}{{ gpt4oImagePriceText }}\n          </button>\n          </fieldset>\n        </form>\n      </div>\n\n      <!-- Right: Image Display Area -->\n      <div class=\"image-display-panel\">\n        <div class=\"image-header\">\n          <h4>Image Preview</h4>\n          <div class=\"image-actions\" v-if=\"!isDetailView && generatedImages.length > 0\">\n            <button @click=\"clearResults\" class=\"btn-secondary\">\n              <i class=\"fas fa-trash\"></i> Clear\n            </button>\n          </div>\n        </div>\n        \n        <div class=\"image-container\">\n          <!-- ËØ¶ÊÉÖÈ°µÔºöstatus 2 Â±ïÁ§∫ outputUrls -->\n          <div v-if=\"isDetailView && detailData && detailData.status === 2 && detailOutputImages.length > 0\" class=\"image-showcase\">\n            <div v-for=\"(image, index) in detailOutputImages\" :key=\"index\" class=\"image-item\">\n              <div class=\"image-wrapper\">\n                <img :src=\"image.url\" :alt=\"`Generated image ${index + 1}`\" />\n                <div class=\"image-overlay\">\n                  <button @click=\"downloadImage(image)\" class=\"action-btn\">\n                    <i class=\"fas fa-download\"></i>\n                  </button>\n                  <button @click=\"copyImageUrl(image)\" class=\"action-btn\">\n                    <i class=\"fas fa-copy\"></i>\n                  </button>\n                </div>\n              </div>\n              <div class=\"image-info\">\n                <span class=\"image-size\">{{ image.size }}</span>\n                <span class=\"image-time\">{{ image.timestamp }}</span>\n              </div>\n            </div>\n          </div>\n          <!-- ËØ¶ÊÉÖÈ°µÔºöstatus 3 Â§±Ë¥•ÊèêÁ§∫ -->\n          <div v-else-if=\"isDetailView && detailData && detailData.status === 3\" class=\"detail-failure-state\">\n            <div class=\"failure-icon\"><i class=\"fas fa-exclamation-circle\"></i></div>\n            <p class=\"failure-message\">Generation failed. You can debug the parameters and try generating again. Generation failure will not consume credits.</p>\n          </div>\n          <!-- ËØ¶ÊÉÖÈ°µÔºöstatus 1 ÊàñÂä†ËΩΩ‰∏≠ -->\n          <div v-else-if=\"isDetailView && (!detailData || detailData.status === 1)\" class=\"detail-loading-state\">\n            <i class=\"fas fa-spinner fa-spin detail-spinner\"></i>\n            <p>Generating...</p>\n          </div>\n          <!-- ËØ¶ÊÉÖÈ°µÔºöÂÖ∂‰ªñÔºàÂ¶Ç status 2 ‰ΩÜÊó†ÂõæÔºâ -->\n          <div v-else-if=\"isDetailView\" class=\"detail-loading-state\">\n            <p>No output images</p>\n          </div>\n          <!-- ÈùûËØ¶ÊÉÖÈ°µÔºöÊú¨Âú∞ÁîüÊàêÁªìÊûú -->\n          <div v-else-if=\"!isDetailView && generatedImages.length > 0\" class=\"image-showcase\">\n            <div v-for=\"(image, index) in generatedImages\" :key=\"index\" class=\"image-item\">\n              <div class=\"image-wrapper\">\n                <img :src=\"image.url\" :alt=\"`Generated image ${index + 1}`\" />\n                <div class=\"image-overlay\">\n                  <button @click=\"downloadImage(image)\" class=\"action-btn\">\n                    <i class=\"fas fa-download\"></i>\n                  </button>\n                  <button @click=\"copyImageUrl(image)\" class=\"action-btn\">\n                    <i class=\"fas fa-copy\"></i>\n                  </button>\n                </div>\n              </div>\n              <div class=\"image-info\">\n                <span class=\"image-size\">{{ image.size }}</span>\n                <span class=\"image-time\">{{ image.timestamp }}</span>\n              </div>\n            </div>\n          </div>\n          \n          <!-- Empty StateÔºà‰ªÖÈùûËØ¶ÊÉÖÈ°µ‰∏îÊó†ÁªìÊûúÊó∂Ôºâ -->\n          <div v-else-if=\"!isDetailView\" class=\"empty-state\">\n            <div class=\"empty-icon\">\n              <i class=\"fas fa-image\"></i>\n            </div>\n            <h3>Waiting for Image Generation</h3>\n            <p>Configure parameters and click the \"Generate Image\" button to start creating your AI image</p>\n            <div class=\"empty-features\">\n              <div class=\"feature-item\">\n                <i class=\"fas fa-palette\"></i>\n                <span>Multiple Aspect Ratios</span>\n              </div>\n              <div class=\"feature-item\">\n                <i class=\"fas fa-upload\"></i>\n                <span>Support Image Upload</span>\n              </div>\n              <div class=\"feature-item\">\n                <i class=\"fas fa-magic\"></i>\n                <span>Intelligent Prompt Enhancement</span>\n              </div>\n              <div class=\"feature-item\">\n                <i class=\"fas fa-shield-alt\"></i>\n                <span>Fallback Mechanism</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Usage Tips -->\n    <div class=\"usage-tips\">\n      <div class=\"tip-item\">\n        <span class=\"tip-icon\">‚ú®</span>\n        <span>Provide detailed descriptive prompts for better results</span>\n      </div>\n      <div class=\"tip-item\">\n        <span class=\"tip-icon\">üñºÔ∏è</span>\n        <span>Upload reference images to guide generation direction</span>\n      </div>\n      <div class=\"tip-item\">\n        <span class=\"tip-icon\">üìê</span>\n        <span>Support multiple aspect ratios, choose the appropriate ratio</span>\n      </div>\n      <div class=\"tip-item\">\n        <span class=\"tip-icon\">üîÑ</span>\n        <span>Enable the fallback mechanism to improve generation success rate</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, computed, onMounted, watch } from 'vue'\nimport UploadImage from './common/UploadImage.vue'\nimport { useRouter, useRoute } from 'vue-router'\nimport { useAuth } from '~/composables/useAuth'\nimport { useToast } from '~/composables/useToast'\nimport { useModelPrice } from '~/composables/useModelPrice'\nimport { useRecordPolling } from '~/composables/useRecordPolling'\n\nconst router = useRouter()\nconst route = useRoute()\nconst { token } = useAuth()\nconst { showError } = useToast()\nconst { fetchPrices, getPrice, formatCredits } = useModelPrice()\n\nonMounted(() => { fetchPrices() })\n\n// ‰ª∑Ê†ºÔºöGPT 4o Image ÂØπÂ∫îÊ®°Âûã key GPT_4o_image\nconst gpt4oImagePriceText = computed(() => {\n  const credits = getPrice('GPT_4o_image')\n  const str = formatCredits(credits)\n  return str ? `(${str})` : ''\n})\n\nconst formData = reactive({\n  size: '1:1',\n  prompt: '',\n  filesUrl: [],\n  isEnhance: false\n})\n\nconst isGenerating = ref(false)\nconst isUploadingRefs = ref(false)\nconst generatedImages = ref([])\nconst uploadedFiles = ref([])\nconst referenceImagesUploadRef = ref(null)\n\nconst getAuthToken = () => {\n  if (!process.client) return null\n  try {\n    if (token?.value) return token.value\n    return localStorage.getItem('auth_token')\n  } catch {\n    return localStorage.getItem('auth_token')\n  }\n}\n\nconst handleReferenceImages = async (files) => {\n  if (!Array.isArray(files) || files.length === 0) {\n    uploadedFiles.value = []\n    formData.filesUrl = []\n    return\n  }\n\n  isUploadingRefs.value = true\n  try {\n    const formDataUpload = new FormData()\n    files.forEach(file => formDataUpload.append('file', file))\n\n    const headers = { Accept: 'application/json' }\n    const authToken = getAuthToken()\n    if (authToken) headers['Authorization'] = `Bearer ${authToken}`\n\n    const response = await fetch('/api/common/batch-upload', {\n      method: 'POST',\n      headers,\n      body: formDataUpload,\n      credentials: 'include'\n    })\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}))\n      // ‰ºòÂÖà‰ΩøÁî®ÂêéÁ´Ø errorMessageÔºà{ errorCode, errorMessage, type, data }ÔºâÔºõ‰ª£ÁêÜÊäõÂá∫Êó∂Âú® message Èáå\n      const msg =\n        (typeof errorData?.errorMessage === 'string' && errorData.errorMessage.trim())\n          ? errorData.errorMessage.trim()\n          : (typeof errorData?.message === 'string' && errorData.message.trim())\n            ? errorData.message.trim()\n            : (errorData?.userTip || errorData?.error || errorData?.message || 'Upload failed')\n      throw new Error(msg)\n    }\n\n    const data = await response.json()\n    let urls = []\n    if (data.errorCode === '00000' && data.data?.urls && Array.isArray(data.data.urls)) {\n      urls = data.data.urls\n    } else if (data.data?.urls && Array.isArray(data.data.urls)) {\n      urls = data.data.urls\n    } else if (data.fileUrls && Array.isArray(data.fileUrls)) {\n      urls = data.fileUrls\n    }\n\n    if (urls.length === 0) {\n      throw new Error('Invalid response: file URLs not found')\n    }\n\n    formData.filesUrl = urls\n    uploadedFiles.value = files.map((file, i) => ({\n      name: file.name,\n      file,\n      url: urls[i] || URL.createObjectURL(file)\n    }))\n  } catch (error) {\n    console.error('Reference images upload error:', error)\n    showError(error.message || 'Failed to upload reference images', 5000)\n    uploadedFiles.value = []\n    formData.filesUrl = []\n    // ‰∏ä‰º†Â§±Ë¥•Êó∂Ê∏ÖÁ©∫ÁªÑ‰ª∂ÂÜÖÊòæÁ§∫ÁöÑÂõæÁâáÔºåÁî®Êà∑ÂèØÁªßÁª≠ÁÇπÂáª‰∏ä‰º†\n    referenceImagesUploadRef.value?.clearFiles?.()\n  } finally {\n    isUploadingRefs.value = false\n  }\n}\n\nconst { post } = useApi()\nconst { fetchRecordDetailOnce, pollRecordByStatus } = useRecordPolling()\n\n// ËØ¶ÊÉÖÈ°µÔºö‰ªÖ‰ªé URL ËØªÂèñ record-id\nconst routeRecordId = computed(() => route.query['record-id'] || '')\nconst isDetailView = computed(() => !!routeRecordId.value)\nconst detailData = ref(null)\nconst detailLoading = ref(false)\n/** Èò≤Ê≠¢Âêå‰∏Ä recordId Ë¢´ËøûÁª≠Ëß¶Âèë‰∏§Ê¨°ËØ∑Ê±ÇÔºàwatch ÂèØËÉΩËøûÁª≠Ëß¶ÂèëÔºâ */\nconst loadingRecordId = ref(null)\n\nconst detailOutputImages = computed(() => {\n  if (!detailData.value || !Array.isArray(detailData.value.outputUrls)) return []\n  const urls = detailData.value.outputUrls\n  const size = detailData.value.originalData?.size || '1:1'\n  return urls.map((url, i) => ({\n    id: `detail-${i}`,\n    url: typeof url === 'string' ? url : url?.url ?? url?.imageUrl ?? '',\n    size,\n    timestamp: new Date().toLocaleTimeString(),\n    prompt: detailData.value.originalData?.prompt\n  })).filter(img => img.url)\n})\n\nfunction fillFormFromOriginalData(originalData) {\n  if (!originalData || typeof originalData !== 'object') return\n  if (originalData.size) formData.size = originalData.size\n  if (typeof originalData.prompt === 'string') formData.prompt = originalData.prompt\n  if (Array.isArray(originalData.imageUrls)) formData.filesUrl = [...originalData.imageUrls]\n  if (typeof originalData.isEnhance === 'boolean') formData.isEnhance = originalData.isEnhance\n}\n\nfunction getRouteRecordId() {\n  return route.query['record-id'] || ''\n}\nasync function loadDetailByRecordId(recordId) {\n  if (!recordId) return\n  if (getRouteRecordId() !== recordId) return\n  if (loadingRecordId.value === recordId) return\n  loadingRecordId.value = recordId\n  detailLoading.value = true\n  detailData.value = null\n  try {\n    const data = await fetchRecordDetailOnce(recordId)\n    if (getRouteRecordId() !== recordId) return\n    detailData.value = data || null\n    if (data?.originalData) fillFormFromOriginalData(data.originalData)\n    if (data != null && Number(data.status) === 1) {\n      pollRecordByStatus(recordId, { getIsCancelled: () => getRouteRecordId() !== recordId }).then((result) => {\n        if (getRouteRecordId() !== recordId) return\n        detailData.value = result\n        if (result?.originalData) fillFormFromOriginalData(result.originalData)\n      }).catch(() => {})\n    }\n  } catch (e) {\n    console.error('Load record detail failed:', e)\n  } finally {\n    if (loadingRecordId.value === recordId) loadingRecordId.value = null\n    detailLoading.value = false\n  }\n}\n\nwatch(\n  () => route.query['record-id'],\n  (recordId) => {\n    if (recordId) loadDetailByRecordId(recordId)\n    else {\n      loadingRecordId.value = null\n      detailData.value = null\n    }\n  },\n  { immediate: true }\n)\n\nconst generateImage = async () => {\n  if (!formData.prompt?.trim() && (!formData.filesUrl || formData.filesUrl.length === 0)) {\n    showError('At least one of Reference Images and prompt is required')\n    return\n  }\n\n  isGenerating.value = true\n  try {\n    const requestBody = {\n      size: formData.size,\n      imageUrls: Array.isArray(formData.filesUrl) ? formData.filesUrl : [],\n      prompt: formData.prompt?.trim() || '',\n      isEnhance: !!formData.isEnhance\n    }\n\n    const data = await post('/api/image/gpt4o-image/generate', requestBody)\n    const recordId = data?.recordId ?? data?.data?.recordId\n\n    if (recordId) {\n      router.push(`/home/gpt-4o-image/generate?record-id=${encodeURIComponent(recordId)}`)\n      return\n    }\n\n    let urls = data?.outputUrls ?? data?.urls ?? data?.data?.outputUrls ?? data?.images ?? (Array.isArray(data) ? data : [])\n    if (!Array.isArray(urls) || urls.length === 0) {\n      showError('No image URLs in response')\n      return\n    }\n\n    const newImages = urls.map((url, i) => ({\n      id: Date.now() + i,\n      url: typeof url === 'string' ? url : url?.url ?? url?.imageUrl ?? '',\n      size: formData.size,\n      timestamp: new Date().toLocaleTimeString(),\n      prompt: formData.prompt\n    })).filter(img => img.url)\n\n    generatedImages.value.unshift(...newImages)\n  } catch (error) {\n    console.error('Image generation failed:', error)\n    showError(error.message || 'Image generation failed, please try again')\n  } finally {\n    isGenerating.value = false\n  }\n}\n\nconst downloadImage = (image) => {\n  const link = document.createElement('a')\n  link.href = image.url\n  link.download = `gpt4o-image-${Date.now()}.png`\n  link.click()\n}\n\nconst copyImageUrl = async (image) => {\n  try {\n    await navigator.clipboard.writeText(image.url)\n    alert('Image URL copied to clipboard')\n  } catch (error) {\n    console.error('Copy failed:', error)\n  }\n}\n\nconst clearResults = () => {\n  generatedImages.value = []\n}\n</script>\n\n<style scoped>\n.gpt4o-image-tool {\n  width: 100%;\n  height: 100%;\n  padding: 20px;\n  background: #ffffff;\n  border-radius: 16px;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);\n  display: flex;\n  flex-direction: column;\n}\n\n.tool-header {\n  display: flex;\n  align-items: center;\n  padding-bottom: 20px;\n  border-bottom: 1px solid #e2e8f0;\n  margin-bottom: 20px;\n}\n\n.header-left {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n\n.tool-icon {\n  width: 48px;\n  height: 48px;\n  border-radius: 8px;\n  overflow: hidden;\n  margin-right: 16px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: #667eea;\n  color: white;\n  font-size: 20px;\n}\n\n.tool-icon img {\n  width: 48px;\n  height: 48px;\n  object-fit: cover;\n}\n\n.tool-info h3 {\n  margin: 0;\n  font-size: 18px;\n  font-weight: 600;\n  color: #1f2937;\n}\n\n.tool-info p {\n  margin: 0;\n  font-size: 14px;\n  color: #6b7280;\n}\n\n.main-content {\n  display: flex;\n  flex: 1;\n  min-height: 0;\n  gap: 20px;\n}\n\n.config-panel {\n  width: 35%;\n  background: #f8fafc;\n  border-radius: 12px;\n  padding: 20px;\n  border: 1px solid #e2e8f0;\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n}\n\n.config-header {\n  padding: 0 0 20px 0;\n  border-bottom: 1px solid #e2e8f0;\n  margin-bottom: 20px;\n}\n\n.config-header h4 {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 600;\n  color: #1e293b;\n}\n\n.config-form {\n  flex: 1;\n  overflow-y: auto;\n}\n\n.config-fieldset {\n  border: none;\n  margin: 0;\n  padding: 0;\n}\n\n.form-group {\n  margin-bottom: 24px;\n}\n\n.form-group label {\n  display: block;\n  font-size: 14px;\n  font-weight: 600;\n  color: #374151;\n  margin-bottom: 8px;\n}\n\n.form-input, textarea {\n  width: 100%;\n  padding: 12px 16px;\n  border: 1px solid #d1d5db;\n  border-radius: 8px;\n  font-size: 14px;\n  transition: border-color 0.2s ease;\n}\n\n.form-input:focus, textarea:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);\n}\n\n.input-hint {\n  font-size: 12px;\n  color: #6b7280;\n  margin-top: 4px;\n}\n\n.uploading-hint {\n  font-size: 12px;\n  color: #667eea;\n  margin-top: 6px;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.tab-group {\n  display: flex;\n  gap: 8px;\n  background: transparent;\n  border: none;\n  border-radius: 0;\n  padding: 0;\n}\n\n.tab-option {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  padding: 10px 12px;\n  border: 1px solid #e2e8f0;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 14px;\n  font-weight: 500;\n  color: #64748b;\n  background: white;\n}\n\n.tab-option:hover {\n  background: #f8fafc;\n  border-color: #667eea;\n  color: #667eea;\n}\n\n.tab-option.active {\n  background: #667eea;\n  border-color: #667eea;\n  color: white;\n  box-shadow: 0 2px 4px rgba(102, 126, 234, 0.2);\n}\n\n.tab-option i {\n  font-size: 12px;\n}\n\n\n.checkbox-label {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  cursor: pointer;\n  font-weight: 500;\n}\n\n.checkbox-label input[type=\"checkbox\"] {\n  margin: 0;\n}\n\n.generate-btn {\n  width: 100%;\n  padding: 16px 24px;\n  background: linear-gradient(135deg, #667eea, #764ba2);\n  color: white;\n  border: none;\n  border-radius: 12px;\n  font-size: 16px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n}\n\n.generate-btn:hover:not(:disabled) {\n  transform: translateY(-2px);\n  box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);\n}\n\n.generate-btn:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n  transform: none;\n}\n\n\n/* Usage Tips - Horizontal layout like Suno */\n.usage-tips {\n  padding: 20px 30px;\n  border-top: 1px solid #e2e8f0;\n  background: #f8fafc;\n}\n\n.tip-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 8px;\n  font-size: 14px;\n  color: #64748b;\n}\n\n.tip-item:last-child {\n  margin-bottom: 0;\n}\n\n.tip-icon {\n  font-size: 16px;\n  flex-shrink: 0;\n}\n\n.tip-item strong {\n  color: #374151;\n}\n\n.image-display-panel {\n  width: 65%;\n  background: #ffffff;\n  border-radius: 12px;\n  padding: 20px;\n  border: 1px solid #e2e8f0;\n  min-height: 400px;\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n}\n\n.image-header {\n  padding: 24px 24px 16px;\n  border-bottom: 1px solid #e5e7eb;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.image-header h4 {\n  font-size: 18px;\n  font-weight: 600;\n  color: #1a1a1a;\n  margin: 0;\n}\n\n.btn-secondary {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 8px 16px;\n  background: #f3f4f6;\n  color: #374151;\n  border: 1px solid #d1d5db;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 14px;\n  transition: all 0.2s ease;\n}\n\n.btn-secondary:hover {\n  background: #e5e7eb;\n}\n\n.image-container {\n  flex: 1;\n  padding: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-height: 80vh;\n}\n\n.image-showcase {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n  gap: 20px;\n  width: 100%;\n}\n\n.image-item {\n  background: white;\n  border-radius: 12px;\n  overflow: hidden;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  transition: transform 0.2s ease;\n}\n\n.image-item:hover {\n  transform: translateY(-4px);\n}\n\n.image-wrapper {\n  position: relative;\n  aspect-ratio: 1;\n  overflow: hidden;\n}\n\n.image-wrapper img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.image-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 12px;\n  opacity: 0;\n  transition: opacity 0.2s ease;\n}\n\n.image-wrapper:hover .image-overlay {\n  opacity: 1;\n}\n\n.action-btn {\n  width: 40px;\n  height: 40px;\n  background: white;\n  border: none;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.action-btn:hover {\n  background: #f3f4f6;\n  transform: scale(1.1);\n}\n\n.image-info {\n  padding: 12px 16px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-size: 12px;\n  color: #6b7280;\n}\n\n.empty-state {\n  text-align: center;\n  color: #64748b;\n  max-width: 500px;\n  min-height: 60vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n\n.empty-icon {\n  font-size: 72px;\n  color: #cbd5e1;\n  margin-bottom: 24px;\n}\n\n.empty-state h3 {\n  font-size: 28px;\n  font-weight: 600;\n  color: #374151;\n  margin: 0 0 12px 0;\n}\n\n.empty-state p {\n  font-size: 16px;\n  margin: 0 0 32px 0;\n  line-height: 1.6;\n}\n\n.empty-features {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.feature-item {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  justify-content: center;\n  font-size: 16px;\n  color: #64748b;\n  padding: 8px 16px;\n  background: rgba(102, 126, 234, 0.1);\n  border-radius: 8px;\n  transition: all 0.3s ease;\n}\n\n.feature-item i {\n  color: #667eea;\n  width: 20px;\n  font-size: 18px;\n}\n\n.detail-loading-state,\n.detail-failure-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 16px;\n  padding: 40px;\n  text-align: center;\n}\n\n.detail-spinner {\n  font-size: 48px;\n  color: #667eea;\n}\n\n.detail-loading-state p,\n.detail-failure-state p {\n  margin: 0;\n  font-size: 16px;\n  color: #64748b;\n}\n\n.detail-failure-state .failure-icon {\n  font-size: 56px;\n  color: #ef4444;\n}\n\n.detail-failure-state .failure-message {\n  max-width: 420px;\n  line-height: 1.6;\n  color: #374151;\n}\n\n/* Responsive Design */\n@media (max-width: 1024px) {\n  .main-content {\n    flex-direction: column;\n  }\n  \n  .config-panel,\n  .image-display-panel {\n    width: 100%;\n  }\n}\n\n@media (max-width: 768px) {\n  .gpt4o-image-tool {\n    padding: 16px;\n  }\n  \n  .tool-header {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 12px;\n  }\n  \n  .config-header {\n    padding: 0 0 16px 0;\n  }\n  \n  .main-content {\n    flex-direction: column;\n    padding: 20px;\n  }\n  \n  .config-panel, .image-display-panel {\n    min-height: auto;\n  }\n  \n  .tab-group {\n    flex-direction: column;\n    gap: 8px;\n  }\n  \n  .tab-option {\n    padding: 12px 16px;\n    font-size: 15px;\n  }\n  \n  .image-showcase {\n    grid-template-columns: 1fr;\n  }\n  \n}\n</style>\n\n\n"],"version":3}